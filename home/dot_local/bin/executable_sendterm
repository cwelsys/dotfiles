#!/bin/bash

if [[ $# -eq 0 ]]; then
    echo "Usage: sendterm <hostname>"
    echo "Sends current TERM terminfo to the specified remote host"
    exit 1
fi

host="$1"

infocmp -x "$TERM" > "$TERM.terminfo"

scp "$TERM.terminfo" "$host":~/

ssh "$host" "
    if [[ -n \"\$TERMINFO\" ]]; then
        mv ~/$TERM.terminfo \"\$TERMINFO/$TERM.terminfo\"
        tic -x \"\$TERMINFO/$TERM.terminfo\"
        rm -f \"\$TERMINFO/$TERM.terminfo\"
    else
        tic -x ~/$TERM.terminfo
        rm -f ~/$TERM.terminfo
    fi
"

rm -f "$TERM.terminfo"
