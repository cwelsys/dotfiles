{{ if eq .chezmoi.osRelease.id "fedora" -}}
#!/bin/bash
sudo dnf copr enable lilay/topgrade -y
sudo dnf install topgrade -y

if command -v cargo >/dev/null 2>&1; then
	cargo install cargo-update
fi
{{ else if or (eq .chezmoi.osRelease.id "debian") (eq .chezmoi.osRelease.id "ubuntu") (eq .chezmoi.osRelease.id "arch") (eq .chezmoi.osRelease.id "opensuse-leap") (eq .chezmoi.osRelease.id "opensuse-tumbleweed") -}}
#!/bin/bash
# Install topgrade via cargo if available, otherwise use system package manager
if command -v cargo >/dev/null 2>&1; then
	cargo install topgrade cargo-update
{{ if eq .chezmoi.osRelease.id "arch" -}}
elif command -v yay >/dev/null 2>&1; then
	yay -S topgrade --needed --noconfirm
{{ else if or (eq .chezmoi.osRelease.id "opensuse-leap") (eq .chezmoi.osRelease.id "opensuse-tumbleweed") -}}
elif command -v zypper >/dev/null 2>&1; then
	# Topgrade might not be available in openSUSE repos, fall back to manual installation
	curl -L https://github.com/topgrade-rs/topgrade/releases/latest/download/topgrade-v*-x86_64-unknown-linux-gnu.tar.gz | sudo tar -xz -C /usr/local/bin
{{ else -}}
elif command -v apt >/dev/null 2>&1; then
	# For Debian/Ubuntu, install via cargo or download binary
	curl -L https://github.com/topgrade-rs/topgrade/releases/latest/download/topgrade-v*-x86_64-unknown-linux-gnu.tar.gz | sudo tar -xz -C /usr/local/bin
{{ end -}}
fi
{{ end -}}
