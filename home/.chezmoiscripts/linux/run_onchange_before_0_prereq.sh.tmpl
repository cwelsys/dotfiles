#!/bin/bash

{{ if eq .chezmoi.os "linux" -}}
  {{- if eq .chezmoi.osRelease.id "debian" -}}
sudo apt update -y
sudo apt-get install build-essential procps wget curl file git zsh age -y
  {{- else if eq .chezmoi.osRelease.id "fedora" -}}
sudo dnf update -y
sudo dnf group install development-tools -y
sudo dnf install procps-ng wget curl file git age zsh  -y
  {{- else if eq .chezmoi.osRelease.id "arch" -}}
sudo pacman -Syu --noconfirm
sudo pacman -S --needed git base-devel && git clone https://aur.archlinux.org/yay-bin.git && cd yay-bin && makepkg -si
sudo pacman -S --noconfirm base-devel procps-ng wget curl file git zsh age openssh
  {{- else -}}
echo "Unsupported Linux distribution: {{ .chezmoi.osRelease.id }}"
exit 1
  {{- end -}}

  {{- if .isWSL }}
    {{- if eq .chezmoi.osRelease.id "arch" }}
if ! command -v wsl2-ssh-agent &> /dev/null; then
  yay -S wsl2-ssh-agent --needed --noconfirm
fi
    {{- else }}
if ! command -v wsl2-ssh-agent &> /dev/null; then
  mkdir -p ~/.local/bin
  curl -L https://github.com/mame/wsl2-ssh-agent/releases/latest/download/wsl2-ssh-agent -o ~/.local/bin/wsl2-ssh-agent
  chmod +x ~/.local/bin/wsl2-ssh-agent
fi
    {{- end }}
  {{- end -}}
{{- end }}

